<?xml version="1.0"?>
<!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure.dtd">

<!-- =============================================================== -->
<!-- Configure the Jetty Server                                      -->
<!--                                                                 -->
<!-- Documentation of this file format can be found at:              -->
<!-- http://docs.codehaus.org/display/JETTY/jetty.xml                -->
<!--                                                                 -->
<!-- =============================================================== -->


<Configure id='cloud-nuxeo' class="org.eclipse.jetty.webapp.WebAppContext">
  <Set name="contextPath">/nuxeo</Set>
  <Set name="war"><SystemProperty name="jetty.home" default="."/>/nuxeo/nuxeo.war</Set>
  <Set name="extractWAR">false</Set>
  <Set name="copyWebDir">false</Set>
  <Set name="configurationDiscovered">true</Set>
  
    <!-- =========================================================== -->
    <!-- Java Mail jndi declaration, used for mail notification      -->
    <!-- Please change the settings, for the password, you can       -->
    <!-- use the plain text, also you can generate one security      -->
    <!-- according to doc: http://docs.codehaus.org/display/JETTY/Securing+Passwords -->
    <!-- =========================================================== -->
	<New id="mail" class="org.eclipse.jetty.plus.jndi.Resource">
		<Arg></Arg>
     	<Arg>java:/Mail</Arg>
     	<Arg>
       	<New class="org.eclipse.jetty.jndi.factories.MailSessionReference">
        	<Set name="user">zhou@intalio.com</Set>
         	<Set name="password">OBF:1w8x1vv11tag1v9g1thh1th51v961t9y1vu91w8t</Set>
         	<Set name="properties">
           		<New class="java.util.Properties">
             		<Put name="mail.smtp.host">smtp.gmail.com</Put>
             		<Put name="mail.from">intalio@intalio.com</Put>             
             		<Put name="mail.smtp.auth">true</Put>
             		<Put name="mail.smtp.socketFactory.class">javax.net.ssl.SSLSocketFactory</Put>
             		<Put name="mail.smtp.socketFactory.fallback">false</Put>
             		<Put name="mail.smtp.port">465</Put>
             		<Put name="mail.smtp.socketFactory.port">465</Put>
             		<Put name="mail.debug">false</Put>
           		</New>
          	</Set>
       	</New>
  		</Arg>
	</New>

    <!-- ======== Nuxeo Directory Data Source ========= -->
    <New id="nxsqldirectory" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/nxsqldirectory</Arg>
      <Arg>
        <!--
		<New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxsqldirectory</Set>
          <Set name="createDatabase">create</Set>
        </New>
		-->
		<New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
		</New>
      </Arg>
    </New>

    <New id="crmsqldirectory" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/crmsqldirectory</Arg>
      <Arg>
        <!--
		<New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxsqldirectory</Set>
          <Set name="createDatabase">create</Set>
        </New>
		-->
		<New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/intalio?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
		</New>
      </Arg>
    </New>

    <!-- ======== Nuxeo Relations Data Source ========= -->
    <New id="nxrelations" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/nxrelations-default-jena</Arg>
      <Arg>
        <New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxrelations</Set>
          <Set name="createDatabase">create</Set>
        </New>
<!--
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
				<Set name="createDatabase">create</Set>
        </New>

-->
      </Arg>
    </New>

    
    <!-- ======== Nuxeo Comments Data Source ========= -->
    <New id="nxcomments" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/comment-relations</Arg>
      <Arg>
        <New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxcomments</Set>
          <Set name="createDatabase">create</Set>
        </New>
<!--
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
        </New>

-->
      </Arg>
    </New>
    
     <!-- ======== Nuxeo Audits Data Source ========= -->
    <New id="nxaudits" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/nxaudit-logs</Arg>
      <Arg>
<!--
        <New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxaudits</Set>
          <Set name="createDatabase">create</Set>
        </New>
-->
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
        </New>

      </Arg>
    </New>

     <!-- ======== Nuxeo JBPM Data Source ========= -->
    <New id="nxjbpm" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/nxjbpm</Arg>
      <Arg>
<!--
        <New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxjbpm</Set>
          <Set name="createDatabase">create</Set>
        </New>
-->
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
        </New>

      </Arg>
    </New>
    
     <!-- ======== Nuxeo Placeful config Data Source ========= -->
    <New id="placeful_service_ds" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/placeful_service_ds</Arg>
      <Arg>
<!--
        <New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">placeful_service_ds</Set>
          <Set name="createDatabase">create</Set>
        </New>
-->
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
        </New>

      </Arg>
    </New>

     <!-- ======== Nuxeo Web Widgets Data Source ========= -->
    <New id="nxwebwidgets" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/nxwebwidgets</Arg>
      <Arg>
<!--
        <New class="org.apache.derby.jdbc.EmbeddedDataSource">
          <Set name="databaseName">nxwebwidgets</Set>
          <Set name="createDatabase">create</Set>
        </New>
-->
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
        </New>

      </Arg>
    </New>
 
     <!-- ======== Tags Data Source ========= -->
    <New id="nxtags" class="org.eclipse.jetty.plus.jndi.Resource">
      <Arg></Arg>
      <Arg>jdbc/nxtags</Arg>
      <Arg>
<!--
        <New class="org.h2.jdbcx.JdbcDataSource">
          <Set name="URL">jdbc:h2:data/h2/vcsh2repo;AUTO_SERVER=true;create=true</Set>
        <Set name="user">sa</Set>
        </New>
-->
       <New class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
                 <Set name="Url">jdbc:mysql://localhost:3306/nuxeo?useUnicode=true&amp;characterEncoding=UTF-8&amp;characterSetResults=UTF-8</Set>
                 <Set name="User">intalio</Set>
                 <Set name="Password">intalio</Set>
        </New>

      </Arg>
    </New>
</Configure>    